<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Water Sort Puzzle â€“ 3D UI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- ========== STYLES ========== -->
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --accent: #38bdf8;
      --accent-2: #22c55e;
      --danger: #ef4444;
      --tube-glass: rgba(255,255,255,0.08);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, #1e293b, #020617);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: #e5e7eb;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      margin: 20px 0 10px;
      font-size: 1.8rem;
      letter-spacing: 0.5px;
    }

    /* ======= TOP BAR ======= */
    .top-bar {
      display: flex;
      gap: 12px;
      margin-bottom: 10px;
    }

    .btn {
      padding: 10px 16px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: linear-gradient(145deg, #38bdf8, #0ea5e9);
      color: #020617;
      font-weight: 600;
      box-shadow: 0 8px 20px rgba(56,189,248,0.35);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }

    .btn.secondary {
      background: linear-gradient(145deg, #22c55e, #16a34a);
      box-shadow: 0 8px 20px rgba(34,197,94,0.35);
    }

    .btn.danger {
      background: linear-gradient(145deg, #ef4444, #dc2626);
      box-shadow: 0 8px 20px rgba(239,68,68,0.35);
      color: #fff;
    }

    .btn:active {
      transform: translateY(2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }

    /* ======= LEVEL SELECT ======= */
    .levels {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      max-width: 420px;
      margin-bottom: 16px;
    }

    .level {
      background: linear-gradient(145deg, #1f2937, #020617);
      border-radius: 14px;
      padding: 12px 0;
      text-align: center;
      cursor: pointer;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.05),
                  0 6px 18px rgba(0,0,0,0.6);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }

    .level:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.7);
    }

    .level.active {
      outline: 2px solid var(--accent);
    }

    /* ======= GAME AREA ======= */
    .game {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      width: 100%;
      padding-bottom: 30px;
    }

    .tubes {
      display: flex;
      flex-wrap: wrap;
      gap: 22px;
      justify-content: center;
      perspective: 900px;
      max-width: 900px;
    }

    .tube {
      width: 70px;
      height: 220px;
      border-radius: 18px;
      background: linear-gradient(
        to bottom,
        rgba(255,255,255,0.15),
        rgba(255,255,255,0.03)
      );
      box-shadow:
        inset 0 0 0 2px rgba(255,255,255,0.08),
        inset 0 -8px 12px rgba(0,0,0,0.4),
        0 20px 35px rgba(0,0,0,0.7);
      transform-style: preserve-3d;
      transform: rotateX(8deg);
      display: flex;
      flex-direction: column-reverse;
      padding: 10px 8px;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .tube.selected {
      transform: rotateX(8deg) translateY(-10px);
      box-shadow: 0 25px 45px rgba(56,189,248,0.6);
    }

    .liquid {
      width: 100%;
      height: 22%;
      border-radius: 10px;
      animation: pour 0.35s ease;
    }

    @keyframes pour {
      from { transform: scaleY(0.1); opacity: 0.2; }
      to { transform: scaleY(1); opacity: 1; }
    }

    .paused-overlay {
      position: fixed;
      inset: 0;
      background: rgba(2,6,23,0.85);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10;
      flex-direction: column;
      gap: 16px;
    }

    .paused-overlay.show {
      display: flex;
    }

    .paused-overlay h2 {
      font-size: 2rem;
    }

    /* ======= RESPONSIVE ======= */
    @media (max-width: 600px) {
      .tube { width: 60px; height: 200px; }
      .liquid { height: 20%; }
    }
  </style>
</head>
<body>

  <h1>Water Sort Puzzle</h1>

  <div class="top-bar">
    <button class="btn" id="pauseBtn">Pause</button>
    <button class="btn secondary" id="resumeBtn">Resume</button>
    <button class="btn danger" id="resetBtn">Reset</button>
  </div>

  <div class="levels" id="levels"></div>

  <div class="game">
    <div class="tubes" id="tubes"></div>
  </div>

  <div class="paused-overlay" id="pausedOverlay">
    <h2>Paused</h2>
    <button class="btn secondary" id="resumeBtnOverlay">Resume</button>
  </div>

  <!-- ========== SCRIPT ========== -->
  <script>
    /* ================= CONFIG ================= */
    const COLORS = [
      '#ef4444', '#22c55e', '#3b82f6', '#eab308',
      '#a855f7', '#ec4899', '#06b6d4', '#f97316'
    ];

    const MAX_HEIGHT = 4;
    const TOTAL_LEVELS = 20;

    /* ================= STATE ================= */
    let currentLevel = 1;
    let tubes = [];
    let selectedTube = null;
    let paused = false;

    /* ================= INIT ================= */
    const tubesEl = document.getElementById('tubes');
    const levelsEl = document.getElementById('levels');
    const pauseBtn = document.getElementById('pauseBtn');
    const resumeBtn = document.getElementById('resumeBtn');
    const resumeBtnOverlay = document.getElementById('resumeBtnOverlay');
    const resetBtn = document.getElementById('resetBtn');
    const pausedOverlay = document.getElementById('pausedOverlay');

    function createLevels() {
      for (let i = 1; i <= TOTAL_LEVELS; i++) {
        const l = document.createElement('div');
        l.className = 'level';
        l.textContent = i;
        l.onclick = () => loadLevel(i);
        levelsEl.appendChild(l);
      }
    }

    function generateLevel(level) {
      const colorsCount = Math.min(3 + Math.floor(level / 2), COLORS.length);
      const activeColors = COLORS.slice(0, colorsCount);

      let pool = [];
      activeColors.forEach(c => {
        for (let i = 0; i < MAX_HEIGHT; i++) pool.push(c);
      });

      pool.sort(() => Math.random() - 0.5);

      const tubeCount = colorsCount + 2;
      let result = [];

      for (let i = 0; i < tubeCount; i++) result.push([]);

      pool.forEach((color, i) => {
        result[i % colorsCount].push(color);
      });

      return result;
    }

    function loadLevel(level) {
      currentLevel = level;
      selectedTube = null;
      tubes = generateLevel(level);

      document.querySelectorAll('.level').forEach((el, idx) => {
        el.classList.toggle('active', idx + 1 === level);
      });

      render();
    }

    /* ================= GAME LOGIC ================= */
    function canPour(from, to) {
      if (from.length === 0) return false;
      if (to.length === MAX_HEIGHT) return false;
      if (to.length === 0) return true;
      return from[from.length - 1] === to[to.length - 1];
    }

    function isComplete() {
      return tubes.every(t =>
        t.length === 0 || (t.length === MAX_HEIGHT && t.every(c => c === t[0]))
      );
    }

    function handleTubeClick(index) {
      if (paused) return;

      if (selectedTube === null) {
        if (tubes[index].length === 0) return;
        selectedTube = index;
      } else {
        if (selectedTube !== index && canPour(tubes[selectedTube], tubes[index])) {
          const color = tubes[selectedTube].pop();
          tubes[index].push(color);
        }
        selectedTube = null;
      }

      render();

      if (isComplete()) {
        setTimeout(() => {
          if (currentLevel < TOTAL_LEVELS) loadLevel(currentLevel + 1);
        }, 600);
      }
    }

    /* ================= RENDER ================= */
    function render() {
      tubesEl.innerHTML = '';

      tubes.forEach((tube, i) => {
        const t = document.createElement('div');
        t.className = 'tube' + (selectedTube === i ? ' selected' : '');
        t.onclick = () => handleTubeClick(i);

        tube.forEach(color => {
          const l = document.createElement('div');
          l.className = 'liquid';
          l.style.background = color;
          t.appendChild(l);
        });

        tubesEl.appendChild(t);
      });
    }

    /* ================= PAUSE / RESUME ================= */
    function pauseGame() {
      paused = true;
      pausedOverlay.classList.add('show');
    }

    function resumeGame() {
      paused = false;
      pausedOverlay.classList.remove('show');
    }

    pauseBtn.onclick = pauseGame;
    resumeBtn.onclick = resumeGame;
    resumeBtnOverlay.onclick = resumeGame;
    resetBtn.onclick = () => loadLevel(currentLevel);

    /* ================= START ================= */
    createLevels();
    loadLevel(1);
  </script>
</body>
  </html>
  
